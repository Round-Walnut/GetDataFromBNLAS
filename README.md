# GetDataFromBNLAS (BLNAS 数据后处理工具)

Get Data From BNLAS(Bridge NonLiner Anlysis System, a suspension bridge analysis system)

## 工具概述

这是一个用于处理 BLNAS 计算结果数据的 Python 脚本，主要功能包括：
1. 读取主缆分跨点坐标和缆力数据
2. 读取吊杆理论下料长度和面积数据
3. 计算吊杆力
4. 将处理后的数据输出到 Excel 文件

## 主要功能模块

### 1. 主缆数据处理 (`GetMainCalbeData` 函数)
- 从 `4-主缆分跨点坐标-填入.txt` 读取主缆分跨点坐标
- 从 `1-成桥设计线型结果.txt` 读取分点缆力数据
- 返回三个数据结构：
  - `span_split_node`: 主缆分跨点坐标列表
  - `span_split_node_force`: 分点缆力字典
  - `spans`: 分跨数据列表

### 2. 吊杆力数据处理 (`GetHangerForce` 函数)
- 从 `2-吊索理论下料长度.txt` 读取吊杆理论下料长度数据
- 返回吊杆参数的多重列表结构

### 3. 吊杆面积处理 (`GetHangerArea` 函数)
- 从 `3-吊索编号及吊索面积.txt` 读取吊杆截面积数据
- 返回吊杆面积列表

### 4. Excel 写入功能 (`WriteActiveExcel` 函数)
- 使用 xlwings 库将数据写入当前活动 Excel 工作簿
- 支持新建工作表写入数据

### 5. 主处理函数 (`BLNASToMidas` 函数)
- 整合上述功能，完成完整的数据处理流程
- 输出三种数据到 Excel:
  1. 主缆坐标数据
  2. 主缆力数据
  3. 吊杆力数据

## 使用说明

1. **输入文件准备**:
   - 确保以下文件存在于同一目录下:
     - `1-成桥设计线型结果.txt`
     - `2-吊索理论下料长度.txt`
     - `3-吊索编号及吊索面积.txt`
     - `4-主缆分跨点坐标-填入.txt`
     - `5-吊索弹模.txt`

2. **运行程序**:
   - 直接运行脚本即可
   - 处理结果会自动写入新的 Excel 工作表

3. **输出结果**:
   - 程序会创建三个新工作表分别包含:
     1. 主缆坐标数据 (x/m, y/m)
     2. 主缆力数据 (缆段编号, 主缆力/kN)
     3. 吊杆力数据 (吊索编号, 吊索力/kN)

## 注意事项

1. **文件格式要求**:
   - 输入文本文件的格式必须与示例文件一致
   - 特别注意分隔符和空格的处理

2. **依赖库**:
   - 需要安装 `xlwings` 库 (`pip install xlwings`)
   - 需要安装 Excel 软件

3. **数据验证**:
   - 程序会打印读取的数据量信息，可用于验证数据是否正确读取

4. **吊杆力计算**:
   - 使用吊杆变形和面积结合弹模计算吊杆力
   - 计算公式: `力 = (变形量/原长) * 弹模 * 面积`

## 改进建议

1. 增加输入文件存在性检查
2. 添加更详细的错误处理和日志记录
3. 提供更灵活的输出选项（如指定输出文件路径）
4. 增加数据验证功能，确保输入数据格式正确
5. 考虑添加图形化用户界面

## 维护信息

- 原始作者: HYT, xx, syz, cqx

## exe发布
exe文件用pyinstaller打包，打包命令为：


## 期望

欢迎issue和pull request，共同完善此工具。
